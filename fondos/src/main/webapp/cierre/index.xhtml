<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html" xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui" xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:b="http://bootsfaces.net/ui">

<ui:composition template="../template.xhtml">
	<ui:define name="title">
		<h:outputText value="#{myBundle.AppName}"></h:outputText>
	</ui:define>


	<ui:define name="body">
		<style>
</style>

		<f:event listener="#{cierreMensualMB.preRender}" type="preRenderView"></f:event>


		<div class="titlePage">
			<b:container fluid="true">
				<h:form id="idDetailPresupuesto">
					<b:row>
						<b:column col-xs="12">
							<h2 class="headerPage"
								style="margin: auto; width: 50%; padding: 10px; font-size: 2.1em;">

								#{usuarioSessionMB.presupuestoSelected.nombrePresupuesto}</h2>
						</b:column>
					</b:row>
					<b:row>
						<b:column col-xs="3">
							<h2 class="headerPage">
								<h:outputText value="Cierre mensual" />
							</h2>
						</b:column>

						<b:column col-xs="4">

						</b:column>

						<b:column col-xs="2">
							<h2 class="headerPage">cierre:</h2>
							<h:outputText styleClass="message" value="#{cierreMensualMB.mes.nombre}" />
						</b:column>
						<b:column col-xs="2">
							<h2 class="headerPage">AÃ±o:</h2>
							<h:outputText styleClass="message"
								value="#{usuarioSessionMB.presupuestoSelected.year}" />
						</b:column>
					</b:row>
				</h:form>
				<b:row>
					<hr />
				</b:row>
				<b:row>
					<b:column col-xs="4">
						<b:row>

							<b:column col-xs="12">
								<h1
									style="color: #999999; font-family: arial, sans-serif; font-size: 26px; font-weight: bold; margin-top: 0px; margin-bottom: 1px;">
									Periodo:</h1>
							</b:column>
						</b:row>

						<b:row>
							<b:column col-xs="6" styleClass="message">
								<h:outputText value="#{cierreMensualMB.periodo.inicio.time}">
									<f:convertDateTime pattern="dd/MM/yyyy" />
								</h:outputText>
							</b:column>
							<b:column col-xs="6" styleClass="message">
								<h:outputText value="#{cierreMensualMB.periodo.fin.time}">
									<f:convertDateTime pattern="dd/MM/yyyy" />
								</h:outputText>
							</b:column>
						</b:row>
						<b:row>
							<b:column col-xs="6" styleClass="undermessage">Inicio</b:column>
							<b:column col-xs="6" styleClass="undermessage">Fin</b:column>
						</b:row>
					</b:column>
					<b:column col-xs="4" />
					<b:column col-xs="4">
						<b:row>

							<b:column col-xs="12">
								<h1
									style="color: #999999; font-family: arial, sans-serif; font-size: 26px; font-weight: bold; margin-top: 0px; margin-bottom: 1px;">
									Saldo</h1>
							</b:column>
						</b:row>

						<b:row>
							<b:column col-xs="6" styleClass="message">$<h:outputText
									value="#{cierreMensualMB.montoInicial}">
									<f:convertNumber maxFractionDigits="2" minFractionDigits="2" currencySymbol="$"
										currencyCode="USD" />
								</h:outputText>
							</b:column>
							<b:column col-xs="6" styleClass="message">$<h:outputText
									value="#{cierreMensualMB.montoFinal}">
									<f:convertNumber maxFractionDigits="2" minFractionDigits="2" currencySymbol="$" />
								</h:outputText>
							</b:column>
						</b:row>
						<b:row>
							<b:column col-xs="6" styleClass="undermessage">Inicial</b:column>
							<b:column col-xs="6" styleClass="undermessage">Final</b:column>
						</b:row>
					</b:column>
				</b:row>
				<b:row>
					<hr />
				</b:row>
				<b:row>
					<b:column col-xs="2">
						<b:row>
							<h2 class="headerPage">
								<h:outputText value="Cierres" />
							</h2>
						</b:row>
						<b:row>
							<h:form id="formOrder">
								<p:selectOneMenu value="#{cierreMensualMB.month}">
									<f:selectItem itemLabel="Mes en proceso"
										itemValue="#{usuarioSessionMB.presupuestoSelected.mesCierre}"></f:selectItem>
									<f:selectItems value="#{cierreMensualMB.listCierres}" var="c"
										itemLabel="#{c.mes}" itemValue="#{c.mes}" />

									<p:ajax listener="#{cierreMensualMB.loadInfo()}" process="@this"
										update=":idGastosTable:idTableGastos,:formPrintMov" />
								</p:selectOneMenu>
							</h:form>
						</b:row>
					</b:column>

					<ui:include src="/componentes/botones/print.xhtml">
						<ui:param name="bean" value="#{cierreMensualMB}" />
						<ui:param name="report" value="reportGastos.jasper" />
						<ui:param name="title" value="CUENTA PRESUPUESTOS DE OPERACIONES" />
						<ui:param name="ext" value="xls" />
						<ui:param name="cols" value="1" />
						<ui:param name="form" value="formPrintMov" />
						<ui:param name="titleButton" value="Gasto" />
						<ui:param name="btnClass" value="btn-info" />
					</ui:include>

					<ui:include src="/componentes/botones/print.xhtml">
						<ui:param name="bean" value="#{searchRetencionMB}" />
						<ui:param name="report" value="reportGastosExcluidos.jasper" />
						<ui:param name="title" value="CUENTA PRESUPUESTOS DE OPERACIONES" />
						<ui:param name="ext" value="xls" />
						<ui:param name="cols" value="1" />
						<ui:param name="form" value="formPrintExc" />
						<ui:param name="titleButton" value="Excluidos" />
						<ui:param name="btnClass" value="btn-warning" />
					</ui:include>
					<b:column col-xs="5" styleClass="" />
					<p:commandLink action="#{cierreMensualMB.create()}" oncomplete="PF('wgtCnfCierre').show();">
					<b:column col-xs="1" styleClass="">
						
						<b:row>
							<b:iconAwesome value="lock-open" solid="true" styleClass="btn btn-warning"
								size="2x" />
						</b:row>
						
						<b:row styleClass="undermessage"> Cerrar</b:row>
					</b:column>
					</p:commandLink>
				</b:row>

			</b:container>

		</div>
		<style>
.ui-filter-column .ui-column-customfilter .custom-filter {
	width: 100%;
	box-sizing: border-box;
}
</style>
		<b:panel look="primary" collapsible="false">

			<h:form id="idGastosTable">



				<p:dataTable value="#{cierreMensualMB.list}" id="idTableGastos"
					widgetVar="idTableGastos" var="g" rowIndexVar="indexVar"
					rowStyleClass="#{  g.status eq 'R'?'revert': (g.status eq 'T'?'ingreso':'paid') }">


					<p:column width="10">
						<h:outputText value="#{indexVar+1}" />
					</p:column>
					<p:column headerText="Proveedor" filterBy="#{g.idProveedor.nombre}">
						<h:outputText value="#{g.idProveedor.nombre}" />
					</p:column>
					<p:column headerText="Descripcion" filterBy="#{g.descripcion}">
						<h:outputText value="#{g.descripcion}" />
					</p:column>

					<p:column headerText="Fecha" width="80">
						<h:outputText value="#{g.fecha}">
							<f:convertDateTime pattern="dd/MM/yyyy"></f:convertDateTime>
						</h:outputText>
					</p:column>
					<p:column headerText="Tipo desembolso" field="tipoDesembolso" filterMatchMode="exact"
						filterBy="#{g.idTipoDesembolso.nombre}" width="80">

						<f:facet name="filter">
							<p:selectOneMenu onchange="PF('idTableGastos').filter()"
								styleClass="ui-custom-filter">
								<f:selectItem itemLabel="Todos" itemValue="#{null}" noSelectionOption="true" />
								<f:selectItem itemValue="Cheque" itemLabel="Cheque" />
								<f:selectItem itemValue="Efectivo" itemLabel="Efectivo" />
								<f:selectItem itemValue="Transferencia" itemLabel="Transferencia" />
							</p:selectOneMenu>

						</f:facet>
						<h:outputText value="#{g.idTipoDesembolso.nombre}" />
					</p:column>



					<p:column headerText="No. cheque" width="80">
						<h:outputText value="#{g.cheque}" />
					</p:column>
					<p:column headerText="Total ($)" width="80">
						<h:outputText value="#{g.total}" >
							<f:convertNumber maxFractionDigits="2" minFractionDigits="2" currencySymbol="$" />
						</h:outputText>
					</p:column>
					<p:column headerText="Status" width="80">
						<h:outputText value="#{g.status}" converter="statusMovConverter" />
					</p:column>
					<p:column headerText="Suj Exc." width="50">
						<h:outputText value="#{g.idProveedor.retencion}" />
					</p:column>
					<p:column headerText="Saldo ($)" width="80">
						<h:outputText value="#{g.saldo}">
							<f:convertNumber maxFractionDigits="2" minFractionDigits="2" currencySymbol="$" />
						</h:outputText>
					</p:column>

					<p:column headerText="" width="80">

						<b:iconAwesome styleClass="btn #{g.status.equals('A')? 'btn-danger':'btn-success'}"
							value="#{g.status.equals('A')? 'arrow-up':'arrow-down'}" solid="true"></b:iconAwesome>

					</p:column>


				</p:dataTable>


			</h:form>
		</b:panel>


		<ui:include src="/dialog/confirmCierreCreated.xhtml"></ui:include>

	</ui:define>

</ui:composition>
</html>